<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Weather Widget</title>
  <style>
    body {
      margin: 0;
      font-family: "Segoe UI Variable Display", "Segoe UI", Arial, sans-serif;
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
      background: linear-gradient(to bottom, #87ceeb, #f3f3f3);
      color: #333;
    }
    .weather {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6rem; /* larger spacing for widget look */
      flex-wrap: wrap;
      text-align: left;
    }
    .group {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .icon {
      font-size: 5rem;
    }
    .temp {
      font-size: 3rem;
      font-weight: 600;
      margin: 0;
    }
    .desc {
      font-size: 1.2rem;
      color: #222;
    }
    .rain-info {
      font-size: 1rem;
      margin-bottom: .5rem;
      color: #0078d7;
      font-weight: 500;
    }
    .date {
      font-size: 1rem;
      color: #444;
    }
    .left-group {
      display: flex;
      align-items: center;
      gap: 1.5rem;
    }
    .left-details {
      display: flex;
      flex-direction: column;
    }
    .right-group {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }

    /* Responsive stacking for smaller screens */
    @media (max-width: 600px) {
      .weather {
        flex-direction: column;
        gap: 2rem;
        text-align: center;
      }
      .left-group {
        justify-content: center;
      }
      .right-group {
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="weather">
    <div class="left-group">
      <div class="icon">‚òÄÔ∏è</div>
      <div class="left-details">
        <div class="temp">--¬∞C</div>
        <div class="desc">Loading...</div>
      </div>
    </div>
    <div class="right-group">
      <div class="rain-info">--</div>
      <div class="date">--</div>
    </div>
  </div>

  <script>
    const iconEl = document.querySelector('.icon');
    const tempEl = document.querySelector('.temp');
    const descEl = document.querySelector('.desc');
    const rainEl = document.querySelector('.rain-info');
    const dateEl = document.querySelector('.date');

    const icons = {
      0: "‚òÄÔ∏è", 1: "üå§Ô∏è", 2: "‚õÖ", 3: "‚òÅÔ∏è", 45: "üå´Ô∏è", 48: "üå´Ô∏è", 51: "üå¶Ô∏è", 61: "üåßÔ∏è", 71: "‚ùÑÔ∏è", 95: "‚õàÔ∏è"
    };

    const backgrounds = {
      0: "linear-gradient(to bottom, #87ceeb, #f3f3f3)",
      1: "linear-gradient(to bottom, #a0c4ff, #f3f3f3)",
      2: "linear-gradient(to bottom, #b0c4de, #e0e0e0)",
      3: "linear-gradient(to bottom, #808080, #d3d3d3)",
      61: "linear-gradient(to bottom, #4a90e2, #d0e6f7)",
      71: "linear-gradient(to bottom, #cfd9df, #e2ebf0)",
      95: "linear-gradient(to bottom, #2c3e50, #bdc3c7)"
    };

    async function fetchWeather() {
      try {
        const res = await fetch("https://api.open-meteo.com/v1/forecast?latitude=14.6&longitude=121.0&current_weather=true&daily=precipitation_sum&timezone=auto");
        const data = await res.json();
        if (data.current_weather) {
          const temp = data.current_weather.temperature;
          const code = data.current_weather.weathercode;

          iconEl.textContent = icons[code] || "‚òÄÔ∏è";
          tempEl.textContent = `${temp}¬∞C`;
          descEl.textContent = `Wind: ${data.current_weather.windspeed} km/h`;

          // Change background based on weather code
          document.body.style.background = backgrounds[code] || backgrounds[0];

          // Rain info from daily forecast
          if (data.daily && data.daily.precipitation_sum && data.daily.precipitation_sum[0] > 0) {
            rainEl.textContent = `üåßÔ∏è Expect rain today (${data.daily.precipitation_sum[0]} mm)`;
          } else {
            rainEl.textContent = "‚òÄÔ∏è No rain expected today";
          }

          const now = new Date();
          const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
          dateEl.textContent = now.toLocaleDateString(undefined, options);
        } else {
          tempEl.textContent = "--";
          descEl.textContent = "Weather unavailable";
          rainEl.textContent = "--";
        }
      } catch (e) {
        tempEl.textContent = "--";
        descEl.textContent = "Weather error";
        rainEl.textContent = "--";
      }
    }

    fetchWeather();
    setInterval(fetchWeather, 600000);
  </script>
</body>
</html>
